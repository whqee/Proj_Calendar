C51 COMPILER V9.59.0.0   LCD1602                                                           03/31/2019 17:37:09 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE LCD1602
OBJECT MODULE PLACED IN .\Objects\lcd1602.obj
COMPILER INVOKED BY: D:\A\Keil_MDK5.25\C51\BIN\C51.EXE lcd1602.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Lis
                    -tings\lcd1602.lst) TABS(2) OBJECT(.\Objects\lcd1602.obj)

line level    source

   1          #include "lcd1602.h"
   2          
   3          
   4          
   5          sbit lcd1602_E   = P2^7;      
   6          sbit lcd1602_RW = P2^6;     
   7          sbit lcd1602_RS = P2^5;     
   8          
   9          static void delay5ms(void);
  10          static void lcd1602_wait_noBusy(void);
  11          static void lcd1602_write_cmd(u8 cmd);
  12          static void lcd1602_write_data(u8 dat);
  13          
  14          
  15          
  16          static void lcd1602_wait_noBusy(void)  
  17          {
  18   1          u8 sta = 0;      //
  19   1      
  20   1          LCD1602_DATA_PORT = 0xff;
  21   1          lcd1602_RS = 0;
  22   1          lcd1602_RW = 1;
  23   1          do
  24   1          {
  25   2              lcd1602_E = 1;
  26   2              sta = LCD1602_DATA_PORT;
  27   2              lcd1602_E = 0;    
  28   2          }while(sta & 0x80);
  29   1      }
  30          
  31          static void lcd1602_write_cmd(u8 cmd)   
  32          {
  33   1        lcd1602_wait_noBusy();    
  34   1      
  35   1        lcd1602_E = 0;        
  36   1        lcd1602_RS = 0;       
  37   1        lcd1602_RW = 0;       
  38   1        LCD1602_DATA_PORT = cmd;    
  39   1        lcd1602_E = 1;              
  40   1        lcd1602_E = 0;        
  41   1      }
  42          
  43          static void lcd1602_write_data(u8 dat)      
  44          {
  45   1        lcd1602_wait_noBusy();    
  46   1      
  47   1        lcd1602_E = 0;        
  48   1        lcd1602_RS = 1;       
  49   1        lcd1602_RW = 0;       
  50   1        LCD1602_DATA_PORT = dat;   
  51   1        lcd1602_E = 1;              
  52   1        lcd1602_E = 0;        
  53   1      }
  54          
C51 COMPILER V9.59.0.0   LCD1602                                                           03/31/2019 17:37:09 PAGE 2   

  55          void lcd1602_Init(void)           
  56          {
  57   1        lcd1602_write_cmd(0x38);    
  58   1        delay5ms();         
  59   1        lcd1602_write_cmd(0x38);    
  60   1        delay5ms();         
  61   1        lcd1602_write_cmd(0x38);    
  62   1        delay5ms();         
  63   1        lcd1602_write_cmd(0x38);    
  64   1        lcd1602_write_cmd(0x08);    
  65   1        lcd1602_write_cmd(0x01);    
  66   1        lcd1602_write_cmd(0x06);    
  67   1        lcd1602_write_cmd(0x0c);    
  68   1      }
  69          
  70          
  71          
  72          
  73          void lcd1602_set_cursor(u8 x, u8 y)  
  74          {
  75   1          u8 addr = 0;
  76   1      
  77   1          switch (y)
  78   1        {
  79   2          case 0:           
  80   2            addr = 0x00 + x;    break;  
  81   2          case 1:           
  82   2            addr = 0x40 + x;    break;
  83   2          default:
  84   2                        break;
  85   2        }
  86   1          lcd1602_write_cmd(addr | 0x80);
  87   1      }
  88          
  89          void lcd1602_show_str(u8 x, u8 y, u8 *pStr, u8 size)     
  90          {
  91   1          lcd1602_set_cursor(x, y);      
  92   1          while (size--)
  93   1          {
  94   2              lcd1602_write_data(*pStr++);
  95   2          }
  96   1      }
  97          
  98          void lcd1602_print(u8 *pStr)     
  99          {
 100   1        u8 x = 0;
 101   1          lcd1602_set_cursor(x, 0);      
 102   1          while (*pStr != '\0')
 103   1          {
 104   2              lcd1602_write_data(*pStr++);
 105   2            if(x++ == 15)
 106   2              lcd1602_set_cursor(0, 1);
 107   2          }
 108   1      }
 109          
 110          
 111          static void delay5ms(void)   
 112          {
 113   1          unsigned char a,b;
 114   1          for(b=19;b>0;b--)
 115   1              for(a=130;a>0;a--);
 116   1      }  
C51 COMPILER V9.59.0.0   LCD1602                                                           03/31/2019 17:37:09 PAGE 3   

 117          
 118          
 119          
 120          
 121          
 122          
 123          
 124          
 125          
 126          
 127          
 128          
 129          
 130          
 131          
 132          
 133          
 134          
 135          
 136          
 137          
 138          
 139          
 140          
 141          
 142          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    239    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       9
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
